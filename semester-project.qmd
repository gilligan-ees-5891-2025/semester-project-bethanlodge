---
title: "Put the title of your project here"
subtitle: "EES 4891/5891: Probability and Statistics for Geosciences"
author: "Put your name here"
date: last-modified
---

## Setup

Set up R environment by loading the necessary libraries

```{r setup}
#| message: false
#| warning: false
#| echo: true
#| results: "hide"
library(knitr)
library(scales)
library(tidyverse)
library(ggplot2)
library(tidyr)

# maybe include other libraries:
# library(tidymodels)

# set up default plotting format for ggplot2 graphs
theme_set(theme_bw())
```

## Introduction

Write the introduction: describe what data you're going to study, why you're interested in it, where you obtained the data, and any other relevant background.

### Data set

Describe your data set: what data are you looking at? Where did you get it from (cite publications if relevant), etc. Describe what the data is: what variables are measured, how many observations (rows in a data table) does it contain, etc.

Stalagmites are archives for a wide array of proxy data. Trace element (TE) data can be collected using a LA-ICP-MS. The TE data is often normalised against Ca before being plotted against depth or age. The .csv file contains many minor elements. The ones that will be focused on here will be Mg/Ca, Sr/Ca, U/Ca, P/Ca, Al/Ca and B/Ca. TE data has been collected for the full length of the stalagmite Hato 2.5 (H2.5).

```{r}
data <- read.csv("H2.5.csv")
```

## Descriptive Statistics

Put code and text to calculate and present descriptive statistics for your data. This should include histograms and kernel-density plots of the distribution of each variable you will be studying. If you have multivariate data, a pairs plot is helpful for showing the correlations and covariance between different variables.

Describe the probability distribution of the data: is it normal or some other distribution? Histograms and Q-Q plots can be helpful here.

```{r}
# columns
elements <- c("MgCa", "SrCa", "UCa", "AlCa", "BaCa", "PCa")

# plotting
par(mfrow = c(2, 3))

for (element in elements) {
  qqnorm(data[[element]], main = paste("Q-Q Plot of", element))
  qqline(data[[element]], col = "red")
}

```

```{r}
# pivot_longer
long_data <- pivot_longer(data, 
                          cols = c(MgCa, SrCa, UCa, AlCa, BaCa, PCa),
                          names_to = "Element", 
                          values_to = "Value")

# kernel density plots
ggplot(long_data, aes(x = Value, fill = Element)) +
  geom_density(alpha = 0.6) +
  facet_wrap(~ Element, scales = "free") +
  theme_minimal() +
  labs(title = "Kernel Density Plots of Elemental Ratios",
       x = "Value", y = "Density")

```

```{r}

# pivot_longer
long_data <- pivot_longer(data, 
                          cols = c(MgCa, SrCa, UCa, AlCa, BaCa, PCa),
                          names_to = "Element", 
                          values_to = "Value")

# histogram plotting
ggplot(long_data, aes(x = Value, fill = Element)) +
  geom_histogram(bins = 30, alpha = 0.7, color = "white") +
  facet_wrap(~ Element, scales = "free") +
  theme_minimal() +
  labs(title = "Histograms of Elemental Ratios",
       x = "Value", y = "Count")

```

```{r}
# columns
elements <- c("MgCa", "SrCa", "UCa", "AlCa", "BaCa", "PCa")

par(mfrow = c(2, 3))

for (element in elements) {
  # remove '0' and NaN
  values <- data[[element]]
  log_values <- log10(values[values > 0])
  
  # q-q plots log transformed
  qqnorm(log_values, main = paste("Log10 Q-Q Plot of", element))
  qqline(log_values, col = "red")
}

```

```{r}
# Columns
elements <- c("MgCa", "SrCa", "UCa", "AlCa", "BaCa", "PCa")

# Set up plotting area
par(mfrow = c(2, 3))

# Plot kernel density for each element
for (element in elements) {
  values <- data[[element]]
  log_values <- log10(values[values > 0])  # Filter and log-transform

  plot(density(log_values, na.rm = TRUE),
       main = paste("Log10 Density of", element),
       xlab = paste("log10(", element, ")", sep = ""),
       ylab = "Density",
       col = "darkgreen",
       lwd = 2)
}

```

```{r}
# Set up plotting area
par(mfrow = c(2, 3))

# Plot histogram for each element
for (element in elements) {
  values <- data[[element]]
  log_values <- log10(values[values > 0])  # Filter and log-transform

  hist(log_values,
       main = paste("Log10 Histogram of", element),
       xlab = paste("log10(", element, ")", sep = ""),
       col = "lightcoral",
       border = "white")
}

```

```{r}
df <- read.csv("H2.5.csv")

# Define the elements
elements <- c("MgCa", "SrCa", "UCa", "AlCa", "BaCa", "PCa")

# Subset the data for only those columns
subset_data <- df[, elements]

# Create pairs plot
pairs(subset_data,
      main = "Pairwise Scatterplots of Elemental Ratios",
      pch = 19,
      col = "steelblue")

```

```{r}
# Define the elements again (just to be safe)
elements <- c("MgCa", "SrCa", "UCa", "AlCa", "BaCa", "PCa")

# Subset the data
subset_data <- df[, elements]

# Log-transform and handle non-positive values
log_data <- log10(subset_data)

# Optionally remove rows with any non-finite values (e.g. -Inf from log(0))
log_data <- log_data[apply(log_data, 1, function(row) all(is.finite(row))), ]

# Create the pairs plot
pairs(log_data,
      main = "Pairwise Scatterplots of log10(Elemental Ratios)",
      pch = 19,
      col = "darkred")

```

## Research Questions

This is a place to describe the research questions you want to ask about your data.

It's helpful to use tables and/or graphs to illustrate what you're thinking about and what questions you want to ask.

## Hypotheses and Tests

State hypotheses about your data and describe how you will use tests to test the hypotheses

Put code to implement the analysis and hypothesis tests, and include interpretations of thee

### Hypotheses

State your hypothesis or hypotheses

### Methods

Describe the methods you'll use to analyze your data in preparation for testing hypotheses. Include the analysis code.

### Hypothesis Tests

Details about the hypothesis tests, including code

### Results and Discussion

Results from your hypothesis tests and discussion, interpreting your results

## Conclusions

What did you learn? What results would a reader be interested in? What would be the next steps if you were to continue studying this data after the end of the semester?
